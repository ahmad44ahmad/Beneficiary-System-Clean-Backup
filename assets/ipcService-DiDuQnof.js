import{a9 as n}from"./index-BOMQ6ZnB.js";const l=[{id:"1",name:"جناح الذكور - الدور الأول",section:"ذكور",building:"المبنى الرئيسي",floor:1,is_high_risk:!1},{id:"2",name:"جناح الذكور - الدور الثاني",section:"ذكور",building:"المبنى الرئيسي",floor:2,is_high_risk:!1},{id:"3",name:"جناح الإناث - الدور الأول",section:"إناث",building:"المبنى الرئيسي",floor:1,is_high_risk:!1},{id:"4",name:"العيادة الطبية",section:"خدمات",building:"المبنى الرئيسي",floor:0,is_high_risk:!0},{id:"5",name:"غرفة العزل",section:"خدمات",building:"المبنى الرئيسي",floor:0,is_high_risk:!0},{id:"6",name:"المطبخ الرئيسي",section:"خدمات",building:"المبنى الرئيسي",floor:0,is_high_risk:!0}],d={id:"demo-1",template_name:"Daily IPC Round",template_name_ar:"الجولة اليومية لمكافحة العدوى",category:"hygiene",is_active:!0,checklist_items:{hand_moment_1:{ar:"قبل ملامسة المريض/المستفيد",weight:10,category:"5_moments"},hand_moment_2:{ar:"قبل الإجراء التعقيمي",weight:10,category:"5_moments"},hand_moment_3:{ar:"بعد التعرض لسوائل الجسم",weight:10,category:"5_moments"},hand_moment_4:{ar:"بعد ملامسة المريض/المستفيد",weight:10,category:"5_moments"},hand_moment_5:{ar:"بعد ملامسة محيط المريض",weight:10,category:"5_moments"},sanitizer_available:{ar:"توفر المعقم في نقاط الرعاية",weight:5,category:"supplies"},soap_filled:{ar:"موزعات الصابون ممتلئة",weight:5,category:"supplies"},ppe_gloves:{ar:"توفر القفازات بأحجام متعددة",weight:8,category:"ppe"},ppe_gowns:{ar:"توفر العباءات الواقية",weight:8,category:"ppe"},ppe_masks:{ar:"توفر الكمامات الطبية",weight:8,category:"ppe"},waste_yellow:{ar:"فرز النفايات الطبية (الحاوية الصفراء)",weight:8,category:"waste"},sharps_safe:{ar:"حاويات الأدوات الحادة آمنة",weight:8,category:"waste"}}},u={totalInspections:24,avgComplianceRate:87,complianceTrend:3,activeIncidents:2,incidentsTrend:-1,immunizationRate:94,pendingFollowups:5},a=(e,t)=>{},s=()=>!!n,h={async getLocations(){if(!s())return l;try{const{data:e,error:t}=await n.from("locations").select("*").order("section");return t||!(e!=null&&e.length)?l:e}catch{return l}},async getChecklistTemplates(){if(!s())return[d];try{const{data:e,error:t}=await n.from("ipc_checklist_templates").select("*").eq("is_active",!0);return t||!(e!=null&&e.length)?[d]:e}catch{return[d]}},async getInspections(e=50){if(!s())return[];try{const{data:t,error:r}=await n.from("ipc_inspections").select("*, locations(*)").order("inspection_date",{ascending:!1}).limit(e);return r?(a("getInspections",r),[]):t||[]}catch{return[]}},async saveInspection(e){if(!s())return console.log("[IPCService] Demo mode - inspection not saved:",e),{success:!0,id:"demo-"+Date.now()};try{const{data:t,error:r}=await n.from("ipc_inspections").insert(e).select("id").single();return r?(a("saveInspection",r),{success:!1}):{success:!0,id:t.id}}catch{return{success:!1}}},async getIncidents(e){if(!s())return[];try{let t=n.from("ipc_incidents").select("*").order("detection_date",{ascending:!1});e&&(t=t.eq("status",e));const{data:r,error:i}=await t;return i?(a("getIncidents",i),[]):r||[]}catch{return[]}},async saveIncident(e){if(!s())return console.log("[IPCService] Demo mode - incident not saved:",e),{success:!0,id:"demo-"+Date.now()};try{const{data:t,error:r}=await n.from("ipc_incidents").insert(e).select("id").single();return r?(a("saveIncident",r),{success:!1}):{success:!0,id:t.id}}catch{return{success:!1}}},async getImmunizations(e){if(!s())return[];try{let t=n.from("immunizations").select("*").order("date_administered",{ascending:!1});e&&(t=t.eq("person_type",e));const{data:r,error:i}=await t;return i?(a("getImmunizations",i),[]):r||[]}catch{return[]}},async getIPCStats(){if(!s())return u;try{const e=new Date;e.setDate(e.getDate()-7);const{data:t,error:r}=await n.from("ipc_inspections").select("compliance_score, follow_up_required").gte("inspection_date",e.toISOString().split("T")[0]),{data:i,error:m}=await n.from("ipc_incidents").select("id").in("status",["open","investigating","containment"]);if(r||m)return u;const o=(t==null?void 0:t.length)||0,g=o>0?Math.round(t.reduce((c,p)=>c+(p.compliance_score||0),0)/o):0,_=(t==null?void 0:t.filter(c=>c.follow_up_required).length)||0;return{totalInspections:o,avgComplianceRate:g,complianceTrend:0,activeIncidents:(i==null?void 0:i.length)||0,incidentsTrend:0,immunizationRate:94,pendingFollowups:_}}catch{return u}},async getWeeklyComplianceData(){return[{week:"الأسبوع 1",compliance:82,incidents:4},{week:"الأسبوع 2",compliance:85,incidents:3},{week:"الأسبوع 3",compliance:84,incidents:2},{week:"الأسبوع 4",compliance:87,incidents:2}]}};export{h as i};
