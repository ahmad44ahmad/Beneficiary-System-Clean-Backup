import{r as a,a9 as y,j as e,L as v,a3 as w,t as o,P as _,J as S,aK as C,a1 as L,aL as k,ao as A,V as E,T,ah as P,a7 as B}from"./index-BOMQ6ZnB.js";const M=()=>{const[r,h]=a.useState([]),[m,i]=a.useState(!0),[l,u]=a.useState(""),[c,g]=a.useState("all"),[p,n]=a.useState(!1);a.useEffect(()=>{j()},[]);const j=async()=>{i(!0);const{data:s,error:t}=await y.from("om_assets").select("*").order("created_at",{ascending:!1});t?console.error("Error fetching assets:",t):h(s||[]),i(!1)},N=s=>{switch(s){case"active":return e.jsx(B,{className:"w-4 h-4 text-green-500"});case"under_maintenance":return e.jsx(P,{className:"w-4 h-4 text-amber-500"});case"out_of_service":return e.jsx(T,{className:"w-4 h-4 text-red-500"});case"disposed":return e.jsx(E,{className:"w-4 h-4 text-gray-400"});default:return null}},b=s=>({active:"نشط",under_maintenance:"تحت الصيانة",out_of_service:"خارج الخدمة",disposed:"تم التخلص منه",transferred:"تم نقله"})[s]||s,f=s=>{const t={excellent:"bg-green-100 text-green-800",good:"bg-blue-100 text-blue-800",fair:"bg-yellow-100 text-yellow-800",poor:"bg-orange-100 text-orange-800",unusable:"bg-red-100 text-red-800"},d={excellent:"ممتاز",good:"جيد",fair:"مقبول",poor:"ضعيف",unusable:"غير صالح"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t[s]||"bg-gray-100"}`,children:d[s]||s})},x=r.filter(s=>{const t=s.name_ar.includes(l)||s.asset_code.toLowerCase().includes(l.toLowerCase()),d=c==="all"||s.status===c;return t&&d});return e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(v,{to:"/operations",className:"flex items-center gap-2 text-gray-500 hover:text-gray-700 mb-2",children:[e.jsx(w,{className:"w-4 h-4"}),"العودة للتشغيل والصيانة"]}),e.jsxs("h1",{className:"text-2xl font-bold text-hrsd-primary flex items-center gap-3",children:[e.jsx(o,{className:"w-7 h-7"}),"سجل الأصول"]}),e.jsx("p",{className:"text-gray-500 mt-1",children:"إدارة وتتبع جميع أصول المركز"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-hrsd-primary text-white rounded-lg hover:bg-hrsd-primary/90 flex items-center gap-2 shadow-lg",children:[e.jsx(_,{className:"w-5 h-5"}),"إضافة أصل جديد"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 min-w-[250px] relative",children:[e.jsx(S,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"البحث بالاسم أو الرمز...",value:l,onChange:s=>u(s.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-hrsd-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:c,onChange:s=>g(s.target.value),className:"px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-hrsd-primary",children:[e.jsx("option",{value:"all",children:"جميع الحالات"}),e.jsx("option",{value:"active",children:"نشط"}),e.jsx("option",{value:"under_maintenance",children:"تحت الصيانة"}),e.jsx("option",{value:"out_of_service",children:"خارج الخدمة"}),e.jsx("option",{value:"disposed",children:"تم التخلص منه"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.filter(s=>s.status==="active").length}),e.jsx("p",{className:"text-sm text-gray-500",children:"أصول نشطة"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-amber-600",children:r.filter(s=>s.status==="under_maintenance").length}),e.jsx("p",{className:"text-sm text-gray-500",children:"تحت الصيانة"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:r.filter(s=>s.status==="out_of_service").length}),e.jsx("p",{className:"text-sm text-gray-500",children:"خارج الخدمة"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-hrsd-primary",children:[r.reduce((s,t)=>s+(t.current_book_value||0),0).toLocaleString()," ر.س"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي القيمة"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:m?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"جاري التحميل..."}):x.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(o,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"لا توجد أصول مسجلة"}),e.jsx("button",{onClick:()=>n(!0),className:"mt-4 text-hrsd-primary hover:underline",children:"إضافة أول أصل"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-right",children:"رمز الأصل"}),e.jsx("th",{className:"p-4 text-right",children:"اسم الأصل"}),e.jsx("th",{className:"p-4 text-center",children:"الموقع"}),e.jsx("th",{className:"p-4 text-center",children:"الحالة"}),e.jsx("th",{className:"p-4 text-center",children:"الحالة الفنية"}),e.jsx("th",{className:"p-4 text-right",children:"القيمة الدفترية"}),e.jsx("th",{className:"p-4 text-center",children:"إجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:x.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 font-mono text-sm",children:s.asset_code}),e.jsx("td",{className:"p-4 font-medium",children:s.name_ar}),e.jsx("td",{className:"p-4 text-center text-sm text-gray-600",children:s.building||"-"}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[N(s.status),e.jsx("span",{className:"text-sm",children:b(s.status)})]})}),e.jsx("td",{className:"p-4 text-center",children:s.condition&&f(s.condition)}),e.jsxs("td",{className:"p-4 text-right font-medium",children:[((t=s.current_book_value)==null?void 0:t.toLocaleString())||"-"," ر.س"]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-blue-600",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-amber-600",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg text-red-600",children:e.jsx(A,{className:"w-4 h-4"})})]})})]},s.id)})})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 max-w-2xl w-full mx-4 shadow-2xl",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"إضافة أصل جديد"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"سيتم تفعيل هذه الميزة قريباً"}),e.jsx("button",{onClick:()=>n(!1),className:"px-6 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:"إغلاق"})]})})]})};export{M as AssetRegistry,M as default};
