import{r as n,a9 as p,j as e,bQ as v,a7 as _,l as y,A as N,d as w,aU as k,a5 as C,T as S,q as M}from"./index-BOMQ6ZnB.js";const E=({beneficiaryId:o})=>{const[m,c]=n.useState(!0),[r,d]=n.useState(!1),[a,u]=n.useState("classification"),[h,x]=n.useState(""),[s,t]=n.useState({disability_classification:"",mental_disability_level:"",motor_disability_type:[],mobility_status:"",gmfcs_level:"",is_bedridden:!1,bmi_value:"",bmi_category:"",diet_type:"",chronic_conditions:{hypertension:{status:"none",medication:!1,notes:""},diabetes:{status:"none",hba1c:"",type:"",notes:""},epilepsy:{status:"none",seizures_last_month:0,controlled:!1,notes:""},asthma:{status:"none",medication:!1,notes:""}},psychological_profile:{diagnosis:[],status:"stable",plan:"",notes:""},injuries_profile:{bedsores:[],wounds:[],fractures:[],burns:[]},infection_status:{hepatitis_b:!1,hepatitis_c:!1,hiv:!1,tb:!1,other:""},rehabilitation_plan:{pt_sessions_count:0,speech_therapy_needed:!1,swallowing_difficulty:!1,notes:""}});n.useEffect(()=>{b()},[o]);const b=async()=>{try{c(!0);const{data:i,error:l}=await p.from("medical_profiles").select("*").eq("beneficiary_id",o).single();l&&l.code!=="PGRST116"&&console.error("Error fetching profile:",l),i&&t({...s,...i,chronic_conditions:i.chronic_conditions||s.chronic_conditions,psychological_profile:i.psychological_profile||s.psychological_profile,injuries_profile:i.injuries_profile||s.injuries_profile,infection_status:i.infection_status||s.infection_status,rehabilitation_plan:i.rehabilitation_plan||s.rehabilitation_plan})}finally{c(!1)}},g=async()=>{try{d(!0);const i={beneficiary_id:o,...s,updated_at:new Date().toISOString()},{error:l}=await p.from("medical_profiles").upsert(i,{onConflict:"beneficiary_id"});if(l)throw l;x("تم حفظ الملف الطبي بنجاح"),setTimeout(()=>x(""),3e3)}catch(i){console.error("Error saving profile:",i),alert("حدث خطأ أثناء الحفظ")}finally{d(!1)}};if(m)return e.jsx("div",{className:"p-8 text-center",children:"جاري تحميل الملف الطبي..."});const j=[{id:"classification",label:"التصنيف والإعاقة",icon:y},{id:"mobility",label:"الحالة الحركية",icon:N},{id:"vitals",label:"العلامات الحيوية",icon:w},{id:"chronic",label:"الأمراض المزمنة",icon:k},{id:"psych",label:"الحالة النفسية",icon:C},{id:"injuries",label:"الإصابات والعدوى",icon:S}];return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden",dir:"rtl",children:[e.jsxs("div",{className:"border-b border-slate-100 bg-slate-50/50 p-4 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-teal-600"}),"الملف الطبي الشامل (Person-Centered Care)"]}),h&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600 bg-green-50 px-3 py-1 rounded-full text-sm",children:[e.jsx(_,{className:"w-4 h-4"}),h]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row min-h-[600px]",children:[e.jsx("div",{className:"w-full md:w-64 bg-slate-50 border-l border-slate-100",children:j.map(i=>e.jsxs("button",{onClick:()=>u(i.id),className:`w-full text-right px-4 py-4 flex items-center gap-3 transition-colors
                ${a===i.id?"bg-white text-teal-700 border-r-4 border-teal-600 font-medium shadow-sm":"text-slate-500 hover:bg-slate-100 hover:text-slate-700"}`,children:[e.jsx(i.icon,{className:`w-5 h-5 ${a===i.id?"text-teal-600":"text-slate-400"}`}),i.label]},i.id))}),e.jsxs("div",{className:"flex-1 p-6 bg-white overflow-y-auto max-h-[800px]",children:[a==="classification"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-800 border-b pb-2",children:"تصنيف الحالة والإعاقة"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"تصنيف الإعاقة الأساسي"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg",value:s.disability_classification,onChange:i=>t({...s,disability_classification:i.target.value}),children:[e.jsx("option",{value:"",children:"ختر التصنيف"}),e.jsx("option",{value:"عقلية",children:"إعاقة عقلية"}),e.jsx("option",{value:"حركية",children:"إعاقة حركية"}),e.jsx("option",{value:"مزدوجة",children:"مزدوجة (عقلية وحركية)"}),e.jsx("option",{value:"نفسية",children:"اضطراب نفسي"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"مستوى الإعاقة العقلية"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg",value:s.mental_disability_level,onChange:i=>t({...s,mental_disability_level:i.target.value}),children:[e.jsx("option",{value:"",children:"غير محدد"}),e.jsx("option",{value:"بسيطة",children:"بسيطة"}),e.jsx("option",{value:"متوسطة",children:"متوسطة"}),e.jsx("option",{value:"شديدة",children:"شديدة"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"نوع الإعاقة الحركية (يمكن اختيار أكثر من خيار)"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["شلل رباعي","شلل نصفي","ضعف طرفين","شلل دماغي"].map(i=>e.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-slate-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.motor_disability_type.includes(i),onChange:l=>{l.target.checked?t({...s,motor_disability_type:[...s.motor_disability_type,i]}):t({...s,motor_disability_type:s.motor_disability_type.filter(f=>f!==i)})},className:"rounded text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:i})]},i))})]})]})]}),a==="mobility"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-800 border-b pb-2",children:"الحالة الحركية و GMFCS"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"مستوى GMFCS (نظام تصنيف الوظائف الحركية الكبرى)"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg",value:s.gmfcs_level,onChange:i=>t({...s,gmfcs_level:i.target.value}),children:[e.jsx("option",{value:"",children:"اختر المستوى"}),e.jsx("option",{value:"1",children:"المستوى 1: يمشي دون قيود"}),e.jsx("option",{value:"2",children:"المستوى 2: يمشي مع قيود"}),e.jsx("option",{value:"3",children:"المستوى 3: يمشي باستخدام أجهزة مساعدة محمولة باليد"}),e.jsx("option",{value:"4",children:"المستوى 4: تنقل ذاتي محدود (كرسي آلي)"}),e.jsx("option",{value:"5",children:"المستوى 5: يعتمد كليا على المساعدة (نقل يدوي)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"وضع التنقل العام"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg",value:s.mobility_status,onChange:i=>t({...s,mobility_status:i.target.value}),children:[e.jsx("option",{value:"",children:"اختر الوضع"}),e.jsx("option",{value:"مستقل",children:"يتحرك بنفسه دون مساعدة"}),e.jsx("option",{value:"مساعدة_بسيطة",children:"يمشي بصعوبة / يحتاج مساعدة بسيطة"}),e.jsx("option",{value:"أجهزة_مساعدة",children:"يمشي باستخدام أجهزة مساعدة"}),e.jsx("option",{value:"كرسي_متحرك",children:"يعتمد على كرسي متحرك"}),e.jsx("option",{value:"طريح_فراش",children:"طريح فراش"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-100 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"bedridden",checked:s.is_bedridden,onChange:i=>t({...s,is_bedridden:i.target.checked}),className:"w-5 h-5 text-red-600 rounded focus:ring-red-500"}),e.jsx("label",{htmlFor:"bedridden",className:"font-medium text-red-800",children:"الحالة طريحة فراش (تنبيه لقرح الفراش)"})]})]})]}),a==="vitals"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-800 border-b pb-2",children:"العلامات الحيوية والتغذية"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-1 border p-4 rounded-lg bg-blue-50/50",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-4",children:"حساب كتلة الجمس (BMI)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"number",placeholder:"الوزن (كجم)",className:"w-full p-2 border rounded",onBlur:i=>{},onChange:i=>t(l=>({...l,bmi_value:i.target.value})),value:s.bmi_value}),e.jsx("input",{type:"text",placeholder:"تصنيف BMI (تلقائي/يدوي)",className:"w-full p-2 border rounded",value:s.bmi_category,readOnly:!0}),e.jsxs("select",{className:"w-full p-2 border rounded bg-white",value:s.bmi_category,onChange:i=>t({...s,bmi_category:i.target.value}),children:[e.jsx("option",{value:"",children:"اختر التصنيف"}),e.jsx("option",{value:"تحت الوزن الطبيعي",children:"تحت الوزن الطبيعي"}),e.jsx("option",{value:"وزن طبيعي",children:"وزن طبيعي"}),e.jsx("option",{value:"زيادة وزن",children:"زيادة وزن"}),e.jsx("option",{value:"سمنة درجة أولى",children:"سمنة درجة أولى"}),e.jsx("option",{value:"سمنة درجة ثانية",children:"سمنة درجة ثانية"}),e.jsx("option",{value:"سمنة مفرطة",children:"سمنة مفرطة"})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"نوع التغذية والحمية"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:["فموي طبيعي","مهروس","سائل كثيف","أنبوبي معدي (PEG)","أنبوبي أنفي (NG Tupe)"].map(i=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"diet",checked:s.diet_type===i,onChange:()=>t({...s,diet_type:i}),className:"text-teal-600"}),e.jsx("span",{className:"text-slate-700",children:i})]},i))})]})]})]}),a==="chronic"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-800 border-b pb-2",children:"الأمراض المزمنة"}),e.jsx("div",{className:"bg-slate-50 p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"font-semibold text-slate-700",children:"ارتفاع ضغط الدم"}),e.jsxs("select",{className:"p-1 border rounded text-sm",value:s.chronic_conditions.hypertension.status,onChange:i=>t({...s,chronic_conditions:{...s.chronic_conditions,hypertension:{...s.chronic_conditions.hypertension,status:i.target.value}}}),children:[e.jsx("option",{value:"none",children:"لا يوجد"}),e.jsx("option",{value:"controlled",children:"مسيطر عليه"}),e.jsx("option",{value:"uncontrolled",children:"صعوبة في السيطرة"})]})]})}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"font-semibold text-slate-700",children:"داء السكري"}),e.jsxs("select",{className:"p-1 border rounded text-sm",value:s.chronic_conditions.diabetes.status,onChange:i=>t({...s,chronic_conditions:{...s.chronic_conditions,diabetes:{...s.chronic_conditions.diabetes,status:i.target.value}}}),children:[e.jsx("option",{value:"none",children:"لا يوجد"}),e.jsx("option",{value:"type1",children:"النوع الأول"}),e.jsx("option",{value:"type2",children:"النوع الثاني"})]})]}),s.chronic_conditions.diabetes.status!=="none"&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("label",{children:"تحليل HbA1c الأخير: "}),e.jsx("input",{type:"text",className:"border rounded p-1 w-20 mx-2",value:s.chronic_conditions.diabetes.hba1c,onChange:i=>t({...s,chronic_conditions:{...s.chronic_conditions,diabetes:{...s.chronic_conditions.diabetes,hba1c:i.target.value}}})})]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"font-semibold text-slate-700",children:"الصرع / التشنجات"}),e.jsxs("select",{className:"p-1 border rounded text-sm",value:s.chronic_conditions.epilepsy.status,onChange:i=>t({...s,chronic_conditions:{...s.chronic_conditions,epilepsy:{...s.chronic_conditions.epilepsy,status:i.target.value}}}),children:[e.jsx("option",{value:"none",children:"لا يوجد"}),e.jsx("option",{value:"active",children:"نشط"}),e.jsx("option",{value:"controlled",children:"تحت السيطرة"})]})]}),s.chronic_conditions.epilepsy.status!=="none"&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("label",{children:"عدد النوبات هذا الشهر: "}),e.jsx("input",{type:"number",className:"border rounded p-1 w-20 mx-2",value:s.chronic_conditions.epilepsy.seizures_last_month,onChange:i=>t({...s,chronic_conditions:{...s.chronic_conditions,epilepsy:{...s.chronic_conditions.epilepsy,seizures_last_month:parseInt(i.target.value)||0}}})})]})]})]}),a==="injuries"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-800 border-b pb-2",children:"الإصابات والعدوى"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"الأمراض المعدية"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 p-2 border rounded bg-white",children:[e.jsx("input",{type:"checkbox",checked:s.infection_status.hepatitis_b,onChange:i=>t({...s,infection_status:{...s.infection_status,hepatitis_b:i.target.checked}})}),e.jsx("span",{children:"التهاب كبد B"})]}),e.jsxs("label",{className:"flex items-center gap-2 p-2 border rounded bg-white",children:[e.jsx("input",{type:"checkbox",checked:s.infection_status.hepatitis_c,onChange:i=>t({...s,infection_status:{...s.infection_status,hepatitis_c:i.target.checked}})}),e.jsx("span",{children:"التهاب كبد C"})]}),e.jsxs("label",{className:"flex items-center gap-2 p-2 border rounded bg-white",children:[e.jsx("input",{type:"checkbox",checked:s.infection_status.hiv,onChange:i=>t({...s,infection_status:{...s.infection_status,hiv:i.target.checked}})}),e.jsx("span",{children:"HIV"})]}),e.jsxs("label",{className:"flex items-center gap-2 p-2 border rounded bg-white",children:[e.jsx("input",{type:"checkbox",checked:s.infection_status.tb,onChange:i=>t({...s,infection_status:{...s.infection_status,tb:i.target.checked}})}),e.jsx("span",{children:"درن"})]})]})]})]}),a==="psych"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx("h3",{className:"text-lg font-medium text-slate-800 border-b pb-2",children:"الحالة النفسية"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"التشخيص النفسي (فيكتور)"}),e.jsxs("select",{className:"w-full p-2 border rounded-lg mb-2",onChange:i=>{i.target.value&&!s.psychological_profile.diagnosis.includes(i.target.value)&&t({...s,psychological_profile:{...s.psychological_profile,diagnosis:[...s.psychological_profile.diagnosis,i.target.value]}})},children:[e.jsx("option",{value:"",children:"إضافة تشخيص..."}),e.jsx("option",{value:"الذهان",children:"الذهان"}),e.jsx("option",{value:"ثنائي القطب",children:"ثنائي القطب"}),e.jsx("option",{value:"الوسواس القهري",children:"الوسواس القهري"}),e.jsx("option",{value:"اضطراب سلوكي",children:"اضطراب سلوكي"}),e.jsx("option",{value:"خرف الشيخوخة",children:"خرف الشيخوخة"}),e.jsx("option",{value:"اكتئاب",children:"اكتئاب"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.psychological_profile.diagnosis.map(i=>e.jsxs("span",{className:"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-sm flex items-center gap-2",children:[i,e.jsx("button",{onClick:()=>t({...s,psychological_profile:{...s.psychological_profile,diagnosis:s.psychological_profile.diagnosis.filter(l=>l!==i)}}),className:"hover:text-red-500",children:"×"})]},i))})]})]})]})]}),e.jsx("div",{className:"border-t p-4 bg-slate-50 flex justify-end gap-3",children:e.jsxs("button",{onClick:g,disabled:r,className:"bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700 flex items-center gap-2 disabled:bg-slate-400",children:[e.jsx(M,{className:"w-4 h-4"}),r?"جاري الحفظ...":"حفظ التغييرات"]})})]})};export{E as ComprehensiveMedicalProfile};
