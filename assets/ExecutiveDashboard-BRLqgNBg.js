import{j as e,d as k,a as b,r as n,c as _,U as C,T as g,A as S,a8 as D,a9 as r}from"./index-BOMQ6ZnB.js";const A=()=>e.jsxs("div",{className:"bg-gradient-to-br from-indigo-900 to-purple-900 rounded-xl p-6 text-white overflow-hidden relative shadow-lg",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full -mr-32 -mt-32 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-purple-500 opacity-10 rounded-full -ml-24 -mb-24 pointer-events-none"}),e.jsxs("h3",{className:"text-indigo-200 font-medium mb-1 flex items-center gap-2 relative z-10",children:[e.jsx(k,{className:"w-5 h-5 text-pink-400"}),"العائد الاجتماعي على الاستثمار (SROI)"]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-8 relative z-10",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-bold mb-1 flex items-baseline gap-1",children:[4.2,e.jsx("span",{className:"text-lg text-indigo-300 font-normal",children:"x"})]}),e.jsx("p",{className:"text-indigo-200 text-sm",children:"كل 1 ريال يُستثمر يحقق أثراً بقيمة 4.2 ريال"})]}),e.jsxs("div",{className:"border-r border-indigo-700 pr-8",children:[e.jsx("p",{className:"text-indigo-300 text-xs uppercase tracking-wider mb-2",children:"القيمة الاجتماعية المولدة"}),e.jsxs("div",{className:"text-2xl font-bold flex items-center gap-1 text-emerald-300",children:[e.jsx(b,{className:"w-5 h-5"}),63e4.toLocaleString()," ",e.jsx("span",{className:"text-sm",children:"ريال"})]}),e.jsx("p",{className:"text-xs text-indigo-400 mt-1",children:"شهرياً (تقديري)"})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-indigo-800/50 grid grid-cols-3 gap-4 text-center relative z-10",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xl font-bold",children:"120+"}),e.jsx("span",{className:"text-xs text-indigo-300",children:"ساعة رعاية"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xl font-bold",children:"95%"}),e.jsx("span",{className:"text-xs text-indigo-300",children:"رضا المستفيدين"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xl font-bold",children:"0%"}),e.jsx("span",{className:"text-xs text-indigo-300",children:"هدر غذائي"})]})]})]}),T=()=>{const[l,d]=n.useState({occupancyCount:0,highRiskCount:0,incidentCount:0,staffCompliance:92}),[i,u]=n.useState(!0),p=[65,78,85,92,88,95];n.useEffect(()=>{(async()=>{try{const{count:t}=await r.from("beneficiaries").select("*",{count:"exact",head:!0}).neq("status","exit"),{count:j}=await r.from("fall_risk_assessments").select("*",{count:"exact",head:!0}).gte("risk_score",45),c=new Date;c.setDate(c.getDate()-7);const{count:v}=await r.from("daily_care_logs").select("*",{count:"exact",head:!0}).not("incidents","is",null).neq("incidents","").gte("log_date",c.toISOString().split("T")[0]);d(s=>({...s,occupancyCount:t||0,highRiskCount:j||0,incidentCount:v||0}));const N=new Date().toISOString().split("T")[0],{data:o}=await r.from("daily_care_logs").select("beneficiary_id").eq("log_date",N),w=new Set(o==null?void 0:o.map(s=>s.beneficiary_id)).size,y=Math.round(w/(t||1)*100);d(s=>({...s,staffCompliance:y}));const{data:m}=await r.from("fall_risk_assessments").select(`
                        id,
                        risk_score,
                        created_at,
                        beneficiaries (full_name)
                    `).gte("risk_score",45).order("created_at",{ascending:!1}).limit(5);m&&f(m.map(s=>{var h;return{id:s.id,title:`خطر سقوط مرتفع (${s.risk_score})`,beneficiary:((h=s.beneficiaries)==null?void 0:h.full_name)||"مستفيد غير معروف",time:new Date(s.created_at).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),type:"critical"}}))}catch(t){console.error("Error fetching dashboard data:",t)}finally{u(!1)}})()},[]);const[x,f]=n.useState([]);return e.jsxs("div",{className:"space-y-6 font-readex animate-fade-in pb-12",dir:"rtl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"لوحة الحقيقة التنفيذية"}),e.jsx("p",{className:"text-gray-500",children:"نظرة شمولية على مؤشرات الأداء والسلامة (بيانات حية)"})]}),e.jsxs("div",{className:"bg-emerald-50 text-emerald-700 px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium shadow-sm",children:[e.jsx(_,{className:"w-5 h-5"}),e.jsxs("span",{children:["آخر تحديث: ",new Date().toLocaleTimeString("ar-SA")]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx(A,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 relative overflow-hidden group hover:shadow-md transition-all",children:[e.jsx("div",{className:"absolute left-0 top-0 w-24 h-24 bg-blue-50 rounded-br-full -ml-4 -mt-4 transition-transform group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:e.jsx(C,{className:"w-6 h-6"})}),e.jsxs("span",{className:"text-sm font-bold text-blue-500 flex items-center gap-1",children:[e.jsx(b,{className:"w-4 h-4"}),"نشط"]})]}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800 mb-1",children:i?"-":l.occupancyCount}),e.jsx("p",{className:"text-gray-500 text-sm",children:"عدد المستفيدين الحالي"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 relative overflow-hidden group hover:shadow-md transition-all",children:[e.jsx("div",{className:"absolute left-0 top-0 w-24 h-24 bg-red-50 rounded-br-full -ml-4 -mt-4 transition-transform group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-red-100 text-red-600 rounded-lg",children:e.jsx(g,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-bold text-red-500",children:"خطر مرتفع"})]}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800 mb-1",children:i?"-":l.highRiskCount}),e.jsx("p",{className:"text-gray-500 text-sm",children:"تقييمات سقوط حرجة"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 relative overflow-hidden group hover:shadow-md transition-all",children:[e.jsx("div",{className:"absolute left-0 top-0 w-24 h-24 bg-orange-50 rounded-br-full -ml-4 -mt-4 transition-transform group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:e.jsx(S,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-bold text-gray-500",children:"آخر 7 أيام"})]}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800 mb-1",children:i?"-":l.incidentCount}),e.jsx("p",{className:"text-gray-500 text-sm",children:"حوادث مسجلة"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 relative overflow-hidden group hover:shadow-md transition-all",children:[e.jsx("div",{className:"absolute left-0 top-0 w-24 h-24 bg-emerald-50 rounded-br-full -ml-4 -mt-4 transition-transform group-hover:scale-110"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-emerald-100 text-emerald-600 rounded-lg",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-bold text-emerald-600",children:"+4%"})]}),e.jsxs("h3",{className:"text-3xl font-bold text-gray-800 mb-1",children:[l.staffCompliance,"%"]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"نسبة إنجاز التقارير اليومية"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 lg:col-span-2",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-6 flex justify-between",children:[e.jsx("span",{children:"مؤشر التحول الرقمي (إلغاء الورق)"}),e.jsx("span",{className:"text-sm text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full",children:"ممتاز"})]}),e.jsx("div",{className:"h-64 flex items-end justify-between gap-4 px-4",children:p.map((a,t)=>e.jsxs("div",{className:"w-full flex flex-col items-center gap-2 group",children:[e.jsx("div",{className:"w-full bg-emerald-100 rounded-t-lg relative overflow-hidden transition-all duration-500 hover:bg-emerald-200 group-hover:h-[102%]",style:{height:`${a}%`},children:e.jsx("div",{className:"absolute bottom-0 w-full bg-emerald-500 h-2 opacity-20"})}),e.jsxs("span",{className:"text-xs text-gray-500 font-medium",children:["أسبوع ",t+1]})]},t))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsxs("h3",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5 text-amber-500"}),"تنبيهات مباشرة (High Risk)"]}),e.jsx("div",{className:"space-y-4",children:x.length===0?e.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"لا توجد تنبيهات نشطة حالياً"}):x.map((a,t)=>e.jsxs("div",{className:"flex gap-4 p-3 bg-gray-50 rounded-lg border border-gray-100 hover:bg-white hover:shadow-sm transition-all cursor-pointer",children:[e.jsx("div",{className:"w-2 h-full rounded-full bg-red-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800 text-sm",children:a.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.beneficiary}),e.jsx("span",{className:"text-[10px] text-gray-400 block mt-1",children:a.time})]})]},t))}),e.jsx("button",{className:"w-full mt-4 py-2 text-sm text-center text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:"عرض كل التنبيهات"})]})]})]})};export{T as ExecutiveDashboard};
